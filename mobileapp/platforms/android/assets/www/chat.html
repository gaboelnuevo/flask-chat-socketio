<ons-navigator var="myNavigator" ng-controller="ChatListController" ng-init="init()">
  <ons-page>
    <ons-toolbar>
      <div class="left">
        <ons-toolbar-button ng-click="menu.toggle()">
          <ons-icon icon="ion-navicon" size="28px" fixed-width="false"></ons-icon>
        </ons-toolbar-button>
      </div>
      <div class="center">Chats <spam ng-model="msgbody"></spam> </div>
    </ons-toolbar>
    <ons-list>
      <ons-list-item modifier="chevron" ng-repeat="chat in chats" ng-click="getMessages(chat.id)">{{chat.name}}</ons-list-item>
    </ons-list>
  </ons-page>
</ons-navigator>
<ons-template id="detail.html">
  <ons-page ng-controller="ChatController" page-scroll-glue="glued" ng-init="init()">
    <ons-toolbar>
      <div class="left"><ons-back-button>Back</ons-back-button></div>
      <div class="center">Page Detail</div>
    </ons-toolbar>
    <ons-pull-hook ng-action="load_olds($done)" var="loader">
        <span ng-switch="loader.getCurrentState()">
          <span ng-switch-when="initial"><ons-icon size="35px" icon="ion-arrow-down-a"></ons-icon> Pull down to refresh</span>
          <span ng-switch-when="preaction"><ons-icon size="35px" icon="ion-arrow-up-a"></ons-icon> Release to refresh</span>
          <span ng-switch-when="action"><ons-icon size="35px" spin="true" icon="ion-load-d"></ons-icon> Loading data...</span>
        </span>
    </ons-pull-hook>
    <ons-list class="timeline" modifier="inset">
      <ons-list-item class="timeline-li" ng-class="{'self': (msg.user.username == me.username)}" ng-repeat="msg in messages" >
        <ons-row id="{{'msg-' +$index}}">
          <ons-col width="50px">
            <img ng-show="{{msg.user.username != me.username}}" ng-src="images/avatar_2x.png" class="timeline-image"/>
          </ons-col>
          <ons-col>
            <div class="chat-bubble" ng-class="(msg.user.username != me.username) ? 'chat-bubble-left' : 'chat-bubble-right'">
              <div class="bubble-content" ng-class="(msg.user.username != me.username) ? 'bubble-content-left' : 'bubble-content-right'">
                <div ng-show="{{msg.user.username != me.username}}" class="timeline-from">
                  <span class="timeline-name"><b>{{msg.user.name}}</b></span>
                  <span class="timeline-id">@{{msg.user.username}}</span>
                </div>
                <div class="timeline-message">
                  {{msg.body}}
                </div>
                <div class="timeline-date" ng-class="{'timeline-date-self': (msg.user.username == me.username)}">3m</div>
              </div>
            </div>
          </ons-col>
        </ons-row>
      </ons-list-item>
    </ons-list>
    <ons-bottom-toolbar class="chat-footer">
        <ons-row align="center">
          <ons-col width="30px"><ons-icon icon="fa-smile-o"></ons-icon></ons-col>
          <ons-col><div class="chat-message-area"><textarea ng-model="msgbody" class="textarea" placeholder=""></textarea></div></ons-col>
          <ons-col width="30px"><a href="#" ng-click="PostMsg()"><ons-icon icon="fa-paper-plane" ></ons-icon></a></ons-col>
        </ons-row>
    </ons-bottom-toolbar>
  </ons-page>
</ons-template>
